// var highestRankedKItems = function (grid, pricing, start, k) {
//   let queue = [start];
//   let reachable = [];
//   let n = grid.length;
//   let m = grid[0].length;
//   let visted = new Array(n);
//   for (let i = 0; i < n; i++) visted[i] = new Array(m).fill(false);
//   let dist = 0;
//   while (queue.length) {
//     let next = [];
//     let dir = [
//       [1, 0],
//       [-1, 0],
//       [0, 1],
//       [0, -1],
//     ];
//     for (let cur of queue) {
//       if (
//         grid[cur[0]][cur[1]] >= pricing[0] &&
//         grid[cur[0]][cur[1]] <= pricing[1]
//       )
//         reachable.push([cur[0], cur[1], grid[cur[0]][cur[1]], dist]);

//       visted[cur[0]][cur[1]] = true;

//       for (let d of dir) {
//         let nextStep = new Array(2);
//         nextStep[0] = d[0] + cur[0];
//         nextStep[1] = d[1] + cur[1];
//         if (
//           nextStep[0] >= 0 &&
//           nextStep[1] >= 0 &&
//           nextStep[0] < n &&
//           nextStep[1] < m &&
//           !visted[nextStep[0]][nextStep[1]] &&
//           grid[nextStep[0]][nextStep[1]]
//         )
//           next.push(nextStep);
//       }
//     }
//     dist++;
//     queue = next;
//   }
//   reachable.sort((s1, s2) => {
//     if (s1[3] !== s2[3]) return s1[3] - s2[3];
//     if (s1[2] !== s2[2]) return s1[2] - s2[2];
//     if (s1[0] !== s2[0]) return s1[0] - s2[0];
//     return s1[1] - s2[1];
//   });
//   reachable = reachable.map((i) => [i[0], i[1]]);
//   return reachable.length <= k ? reachable : reachable.slice(0, k);
// };

var highestRankedKItems = function (grid, pricing, start, k) {
  let allReacheableItems = [];
  let queue = [start];
  let n = grid.length;
  let m = grid[0].length;
  let visited = new Array(n);
  for (let i = 0; i < n; i++) {
    visited[i] = new Array(m).fill(false);
  }

  function isInRange(pricing, value) {
    return value <= pricing[1] && value >= pricing[0];
  }

  const moves = [
    [1, 0],
    [0, 1],
    [-1, 0],
    [0, -1],
  ];

  function getNextMoves(grid, c) {
    let r = grid.length;
    let col = grid[0].length;

    return moves
      .map((m) => [m[0] + c[0], m[1] + c[1]])
      .filter((m) => {
        return (
          m[0] < r &&
          m[0] >= 0 &&
          m[1] < col &&
          m[1] >= 0 &&
          grid[m[0]][m[1]] !== 0
        );
      });
  }

  let dist = 0;
  while (queue.length) {
    let newQ = [];
    for (let i = 0; i < queue.length; i++) {
      let c = queue[i];
      if (visited[c[0]][c[1]]) {
        continue;
      }
      visited[c[0]][c[1]] = true;
      let val = grid[c[0]][c[1]];
      if (val > 1 && isInRange(pricing, val)) {
        allReacheableItems.push([c[0], c[1], val, dist]);
      }

      const nextMoves = getNextMoves(grid, c);
      nextMoves.forEach((nm) => {
        newQ.push(nm);
      });
    }
    dist++;
    queue = newQ;
  }
  allReacheableItems.sort((s1, s2) => {
    if (s1[3] !== s2[3]) {
      return s1[3] - s2[3];
    }
    if (s1[2] !== s2[2]) {
      return s1[2] - s2[2];
    }
    if (s1[0] !== s2[0]) {
      return s1[0] - s2[0];
    }
    return s1[1] - s2[1];
  });
  allReacheableItems = allReacheableItems.map((i) => [i[0], i[1]]);

  if (allReacheableItems.length < k) {
    return allReacheableItems;
  }

  return allReacheableItems.slice(0, k);
};

console.log(
  highestRankedKItems(
    [
      [1, 2, 0, 1],
      [1, 3, 0, 1],
      [0, 2, 5, 1],
    ],
    [2, 5],
    [0, 0],
    3
  )
);
console.log(
  highestRankedKItems(
    [
      [1, 2, 0, 1],
      [1, 3, 3, 1],
      [0, 2, 5, 1],
    ],
    [2, 3],
    [2, 3],
    2
  )
);
console.log(
  highestRankedKItems(
    [
      [1, 1, 1],
      [0, 0, 1],
      [2, 3, 4],
    ],
    [2, 3],
    [0, 0],
    3
  )
);
console.log(
  highestRankedKItems(
    [
      [
        1913, 9572, 1, 7818, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 4510, 1, 0, 3033, 1,
        1, 1602, 1, 7783, 0, 7497, 0, 1115, 1, 0, 8036, 0, 0, 8359, 9137, 1, 1,
        0, 1, 0, 5350, 1057, 814, 1539, 0, 0, 3073, 0, 1, 0, 0, 0, 7998, 6976,
        0, 8434, 2724, 3421, 3982, 188, 1, 1, 5900,
      ],
      [
        1, 0, 0, 0, 0, 1, 1526, 4518, 1, 8494, 0, 0, 1, 2338, 7622, 0, 1177, 1,
        8379, 1, 1, 0, 0, 1, 6481, 3126, 0, 4353, 6824, 0, 6149, 1, 1633, 1, 1,
        1, 0, 1, 0, 3585, 0, 1, 625, 0, 0, 9260, 433, 1, 1, 0, 0, 1, 0, 2077,
        8457, 1, 0, 1, 5679, 1377, 1, 0,
      ],
      [
        4569, 1, 4093, 0, 8875, 0, 1, 0, 1, 0, 2414, 1, 3069, 1, 8452, 4085, 0,
        0, 0, 0, 5800, 1, 1, 4161, 2004, 3802, 2882, 0, 1085, 1, 6239, 0, 826,
        1, 0, 1890, 1, 0, 1, 1941, 1, 0, 8480, 1, 2126, 0, 8892, 6095, 1, 1,
        5167, 1, 0, 1, 0, 1, 5238, 0, 1, 1, 1, 1,
      ],
      [
        0, 2219, 5799, 3199, 1, 1215, 0, 0, 1, 1, 3300, 1, 0, 1, 1, 4714, 4601,
        0, 1, 1, 1971, 6780, 1, 8916, 1, 0, 1, 761, 1, 1, 0, 3893, 1, 1, 4170,
        0, 0, 2719, 6145, 1, 1, 1, 1871, 1, 1, 0, 5045, 8938, 4250, 0, 9904, 0,
        9173, 5262, 1, 1, 3478, 1, 1065, 1806, 0, 7484,
      ],
      [
        5268, 0, 3736, 1314, 6459, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1396, 0, 8665, 0,
        8654, 2118, 7534, 5374, 943, 3755, 4179, 5196, 7213, 9550, 8737, 0, 1,
        1835, 0, 0, 5787, 1, 6184, 1, 1, 1, 7829, 0, 0, 1, 1, 1772, 1854, 1959,
        0, 5102, 1711, 1, 0, 1, 687, 1, 1, 3421, 0, 0, 1, 0,
      ],
      [
        0, 1, 7433, 300, 0, 1, 1, 0, 1, 8534, 0, 9881, 1, 1, 1, 0, 30, 4396,
        6281, 4025, 0, 1, 0, 0, 6089, 3541, 1, 1, 1, 1, 6184, 1, 0, 9317, 9305,
        0, 4866, 1, 1, 0, 0, 0, 0, 1, 0, 8440, 3244, 0, 1, 6726, 1, 3791, 7582,
        5924, 1, 1, 0, 0, 1, 0, 5781, 257,
      ],
      [
        1, 0, 3132, 0, 1, 0, 9046, 8918, 8739, 9844, 0, 1, 8762, 0, 1, 7621, 0,
        0, 8257, 0, 9890, 7506, 3902, 3565, 1, 0, 5866, 3088, 1, 0, 0, 5325,
        999, 1, 1, 1, 0, 3131, 1, 6854, 0, 8254, 1, 0, 5444, 0, 1, 1, 4277, 1,
        1, 0, 6946, 830, 1, 0, 1, 1, 0, 3535, 1641, 1,
      ],
      [
        0, 0, 1, 8318, 0, 0, 6296, 0, 0, 1, 6472, 2696, 0, 5291, 0, 9127, 3113,
        6699, 949, 5138, 0, 0, 0, 8937, 0, 1069, 5128, 0, 8284, 6675, 1, 1, 0,
        0, 1, 1, 1, 9314, 9150, 0, 0, 1, 9769, 0, 9010, 2151, 1, 8718, 8836, 1,
        1, 0, 9191, 6627, 0, 9844, 0, 6446, 0, 1, 0, 5146,
      ],
      [
        1, 5806, 6540, 5438, 1, 5091, 0, 9583, 0, 0, 6076, 0, 2569, 0, 1, 9512,
        1, 1, 7308, 0, 7117, 7759, 0, 0, 1, 5514, 0, 1, 1, 1, 9384, 1, 0, 1,
        4207, 1, 0, 0, 780, 1, 1, 1, 4786, 0, 1, 9416, 3789, 8184, 0, 0, 1,
        6342, 0, 1, 0, 0, 3603, 0, 1, 1, 1, 0,
      ],
      [
        0, 1, 1, 562, 1, 0, 1, 5320, 1, 9673, 3907, 8110, 8033, 0, 2093, 8787,
        1, 1, 1, 1, 6549, 1, 0, 1, 9588, 0, 1, 1, 1, 718, 0, 1, 799, 1, 0, 0, 0,
        737, 4088, 1, 8098, 9704, 1, 1, 8977, 50, 5305, 7472, 6942, 1, 0, 8023,
        0, 0, 0, 0, 8075, 1, 0, 1243, 0, 1,
      ],
      [
        9883, 4550, 3497, 5048, 1, 5619, 7635, 4794, 164, 2098, 4174, 2543, 0,
        0, 1, 0, 8700, 0, 1, 3936, 6900, 1, 0, 1, 1, 0, 1, 0, 9960, 1, 1656,
        5439, 0, 0, 0, 1, 1, 0, 1, 982, 533, 1, 7091, 0, 695, 1, 1, 1, 7842, 1,
        1, 1, 1, 2002, 1, 5160, 3953, 0, 4845, 1, 1, 1240,
      ],
      [
        1, 1, 0, 4940, 9988, 782, 6178, 1, 3174, 1, 0, 1530, 1, 8937, 0, 8669,
        9718, 1, 1, 0, 8298, 3644, 1, 4021, 1276, 0, 1, 9380, 0, 2642, 1, 1, 1,
        0, 3442, 0, 9911, 0, 1, 9994, 1, 1, 0, 0, 8900, 8753, 0, 3845, 1, 0,
        2596, 0, 0, 0, 4122, 0, 4782, 0, 0, 1, 0, 5080,
      ],
      [
        0, 0, 0, 1, 5988, 1, 1, 4783, 0, 1, 1, 5074, 1, 2989, 190, 1, 0, 0, 1,
        1, 1, 3472, 6175, 6343, 0, 4250, 1, 4304, 4940, 8194, 0, 1, 5810, 0,
        7064, 0, 1, 9332, 0, 3957, 1, 5143, 1, 3842, 2694, 6708, 4955, 6442,
        9651, 1, 0, 0, 1, 1, 1186, 8595, 2142, 0, 0, 1233, 0, 0,
      ],
      [
        1, 5560, 6990, 3458, 5432, 0, 5415, 6766, 1, 0, 0, 3387, 1, 1, 1, 4493,
        1, 7904, 3875, 7566, 0, 1, 1, 2491, 0, 0, 6525, 0, 5737, 6746, 4579,
        7669, 7406, 2265, 0, 1, 3298, 1, 7972, 8066, 0, 1, 5873, 1, 0, 0, 844,
        0, 1, 1, 1206, 4194, 0, 5811, 9889, 0, 1, 722, 5033, 0, 0, 835,
      ],
      [
        1, 0, 0, 2434, 0, 7224, 1, 4140, 0, 0, 0, 8643, 0, 7509, 0, 1, 0, 1, 1,
        1, 3238, 1, 0, 0, 0, 1, 621, 1, 8256, 0, 0, 0, 2794, 0, 9547, 2166, 0,
        6691, 2740, 2945, 0, 4852, 3064, 1392, 0, 3516, 9860, 1, 0, 0, 1, 0, 0,
        0, 8373, 5706, 1, 0, 0, 5482, 0, 0,
      ],
      [
        0, 0, 5927, 1, 1, 1, 1, 5659, 1, 1, 1, 689, 0, 1, 0, 1, 1, 7454, 2388,
        526, 1716, 3125, 1, 0, 9576, 1, 0, 0, 1, 0, 1, 0, 3193, 97, 1, 0, 1, 1,
        0, 4867, 7476, 9889, 0, 4994, 6987, 5712, 0, 252, 1, 1, 0, 5264, 1, 0,
        0, 9990, 1, 5535, 1, 1177, 0, 1,
      ],
      [
        1, 0, 1, 0, 1, 8499, 2093, 1, 6797, 1, 0, 1, 9106, 1, 9469, 7978, 0,
        2785, 1, 621, 9870, 3561, 1, 0, 0, 0, 9525, 1, 1, 1, 1, 0, 1, 1, 6507,
        0, 2872, 1, 0, 9539, 0, 2796, 0, 1828, 0, 0, 1, 9699, 8533, 0, 1, 6908,
        1, 1, 1, 4283, 3472, 1, 4385, 1990, 1926, 2942,
      ],
      [
        5532, 217, 5198, 0, 2268, 1, 0, 9802, 1, 1, 7150, 1, 1, 1, 4405, 889, 0,
        0, 4395, 1, 8425, 1, 1, 1, 3820, 1, 1, 0, 7897, 0, 1, 0, 1, 0, 3438, 0,
        0, 9820, 7006, 2113, 0, 1, 7104, 5545, 1, 5698, 1, 7686, 8569, 0, 1, 1,
        8528, 4553, 6221, 3773, 0, 8361, 8851, 0, 4238, 2260,
      ],
      [
        9841, 0, 6630, 1, 7743, 3256, 8652, 1, 1, 2388, 8772, 5006, 6787, 6453,
        6892, 0, 0, 1, 0, 2492, 0, 1, 0, 1, 0, 1, 4316, 1, 0, 0, 0, 0, 3757,
        2525, 4570, 2667, 1, 1, 1, 3036, 0, 8721, 0, 0, 0, 1416, 1, 6659, 0,
        2849, 8096, 1, 1, 8571, 4682, 0, 1, 1, 422, 5288, 1, 1,
      ],
      [
        1, 6817, 1, 1491, 1, 6009, 0, 1, 5489, 3544, 6588, 0, 0, 1, 1, 1, 8544,
        4192, 0, 0, 0, 2713, 8286, 2054, 1, 1, 1, 2408, 1206, 1, 0, 0, 6629, 1,
        1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 5455, 7550, 1, 0, 1, 1, 0, 0, 0, 9328,
        2827, 4901, 0, 435, 8945, 1214, 0, 2130,
      ],
      [
        1, 3735, 1, 9476, 1, 0, 0, 9418, 2251, 4493, 9194, 1, 0, 0, 0, 7981, 1,
        0, 0, 9458, 1, 6936, 1, 1, 1, 4469, 1, 0, 1, 360, 0, 1, 7952, 9137, 1,
        1, 1, 1, 1, 0, 5261, 0, 2733, 1, 3635, 0, 0, 1, 0, 4080, 319, 1, 0,
        4721, 0, 964, 0, 1, 4700, 0, 3508, 0,
      ],
      [
        1, 0, 43, 0, 1, 0, 1, 0, 5666, 1, 1, 0, 5078, 6365, 1, 0, 1, 7003, 0,
        1722, 5974, 8822, 3652, 0, 5493, 0, 0, 3242, 3466, 8220, 9218, 5185,
        5716, 0, 5742, 4990, 0, 7539, 6161, 9736, 3662, 0, 0, 485, 1758, 6557,
        3950, 1, 1, 1, 1, 1, 0, 2865, 4111, 0, 0, 9917, 5512, 1, 0, 8948,
      ],
      [
        6801, 1, 4893, 1, 0, 3948, 0, 3951, 2225, 2983, 1, 0, 0, 1186, 0, 8790,
        0, 0, 488, 1, 1, 8083, 1, 1, 4313, 5022, 9991, 1, 1, 0, 1408, 0, 1,
        8074, 1, 1, 1624, 0, 1, 7505, 3206, 5063, 1, 1, 0, 1, 1, 1, 0, 0, 8707,
        7878, 9303, 8548, 3708, 9276, 0, 397, 5097, 0, 0, 7483,
      ],
      [
        9111, 0, 0, 1473, 0, 1, 0, 2631, 3158, 3847, 658, 1, 1841, 7544, 0, 0,
        1, 6552, 0, 1, 1, 2716, 0, 0, 1, 9948, 2076, 1, 1, 5497, 1, 7791, 1, 0,
        0, 1, 3561, 0, 0, 1, 1274, 3517, 2337, 0, 1, 7293, 0, 1, 0, 0, 0, 5824,
        1, 4631, 1, 1, 2852, 8493, 0, 1316, 2058, 6721,
      ],
      [
        0, 752, 1, 7401, 1, 2509, 1, 2178, 5455, 0, 1, 1983, 1, 1, 1, 0, 1, 769,
        4499, 7007, 0, 3955, 1, 8584, 9251, 5971, 1, 488, 2499, 9187, 9574, 1,
        0, 0, 1, 8495, 0, 6027, 2019, 1, 4469, 6885, 8580, 1796, 5627, 1, 5648,
        1, 3386, 3180, 1, 0, 6101, 0, 1, 9949, 1, 1977, 6901, 9748, 0, 7659,
      ],
      [
        1, 1, 0, 0, 0, 0, 3241, 0, 769, 0, 1513, 1, 8266, 1, 8174, 7920, 1, 0,
        1, 0, 0, 2926, 0, 1, 8335, 0, 1, 0, 0, 0, 6350, 9734, 9363, 1, 1, 4888,
        0, 7380, 2996, 387, 1, 1, 6420, 1, 1, 0, 3066, 1, 8988, 1, 7396, 7405,
        7256, 2057, 1, 1, 1, 1, 1993, 8832, 0, 1,
      ],
      [
        7962, 0, 5431, 2855, 1, 0, 1, 3758, 1, 3081, 6034, 1, 3389, 0, 1, 1,
        5311, 6536, 1, 7676, 2758, 1, 1, 9368, 4991, 1, 3412, 4634, 0, 1, 1, 0,
        90, 8497, 4515, 8036, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 8665, 7517, 476,
        1519, 1, 7222, 1, 7695, 0, 1, 1, 0, 1, 1, 5656, 1,
      ],
      [
        1, 0, 1, 0, 1, 1, 1, 1525, 4298, 5012, 8356, 0, 9921, 0, 787, 2443, 413,
        8627, 3585, 0, 1, 0, 7575, 0, 8773, 0, 0, 3384, 7431, 0, 1, 1, 3216, 0,
        1, 0, 0, 664, 0, 3502, 1202, 7314, 1, 0, 1, 0, 8347, 1, 1, 7850, 0, 1,
        0, 5123, 5345, 0, 6495, 1, 5333, 1, 9655, 3362,
      ],
      [
        1, 4185, 0, 8733, 0, 0, 0, 1, 0, 8396, 8974, 1, 1, 2907, 0, 9853, 0,
        2334, 0, 2619, 7312, 1, 4742, 0, 0, 0, 1, 0, 1, 4944, 6232, 0, 1, 0, 0,
        5157, 0, 1472, 1, 0, 320, 0, 1, 437, 7235, 0, 0, 0, 2118, 7271, 1, 3670,
        9371, 7250, 0, 0, 4493, 669, 1066, 0, 0, 1,
      ],
      [
        0, 0, 2709, 1, 1, 803, 0, 1, 1, 1, 1, 0, 7345, 0, 0, 5113, 1, 1, 1,
        1049, 0, 7102, 5233, 1, 0, 7631, 0, 877, 1, 1647, 0, 7796, 190, 8007, 0,
        6926, 1, 1, 0, 0, 4001, 1, 0, 1, 6234, 1, 6233, 7968, 881, 1, 4522,
        4841, 4795, 1, 3027, 702, 1, 202, 1, 0, 9342, 931,
      ],
      [
        0, 1, 0, 386, 1, 0, 7852, 7561, 9847, 2596, 0, 5719, 4089, 1, 1, 1,
        7172, 0, 8766, 917, 1, 1, 8447, 1, 140, 1, 591, 0, 2439, 0, 488, 3872,
        0, 1726, 0, 0, 419, 0, 2856, 1555, 0, 9942, 0, 1, 0, 2801, 1, 0, 9430,
        1, 1, 1, 1, 5730, 0, 3432, 1, 0, 1, 5655, 803, 921,
      ],
      [
        1, 9038, 9592, 1, 9290, 609, 1, 1452, 0, 0, 5290, 6614, 0, 1, 0, 9033,
        1, 1, 0, 0, 6633, 1, 2116, 386, 3450, 1, 0, 1, 0, 509, 0, 1, 0, 3234, 0,
        1, 0, 8748, 1405, 0, 0, 0, 0, 880, 2825, 131, 3785, 5430, 0, 1276, 0, 0,
        1, 7608, 1087, 0, 0, 4771, 1, 0, 0, 0,
      ],
      [
        0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 802, 0, 8324, 3489, 1248, 4036, 9641,
        8330, 333, 4670, 0, 0, 1742, 1, 0, 0, 2384, 0, 414, 3967, 0, 5819, 1, 0,
        1, 8956, 464, 1, 1, 0, 3015, 0, 1, 1, 0, 0, 6458, 0, 1, 0, 0, 8323, 0,
        0, 6215, 2062, 9460, 1, 0, 1, 6560, 1,
      ],
      [
        0, 0, 0, 0, 0, 0, 1, 3731, 5486, 4599, 1, 0, 0, 0, 1, 0, 0, 1175, 1, 1,
        0, 7887, 2029, 0, 1, 1, 1, 1, 8032, 0, 1673, 0, 1, 1, 0, 177, 7894,
        8713, 0, 0, 9943, 0, 7853, 0, 6524, 1, 0, 0, 2999, 4696, 1, 3550, 0, 0,
        9417, 1, 1, 2906, 382, 853, 3078, 7372,
      ],
      [
        9329, 1, 1, 6130, 1, 4168, 4983, 7189, 4130, 8138, 0, 960, 1, 0, 6116,
        1, 1355, 187, 9524, 1, 1, 9039, 7763, 0, 1, 1, 6551, 1, 7479, 27, 1, 0,
        0, 0, 9687, 5270, 660, 1, 2978, 2645, 3284, 1, 1, 1, 1, 1, 1, 0, 5939,
        0, 0, 0, 2672, 550, 0, 0, 0, 1, 3763, 1, 1, 879,
      ],
      [
        1, 1, 1, 1, 1580, 0, 1, 0, 0, 0, 1, 1, 9742, 1241, 1, 0, 0, 1, 1, 985,
        0, 1, 5931, 1, 1640, 1, 0, 8306, 1, 9291, 1, 1, 5048, 835, 1, 4801, 613,
        0, 2891, 0, 8092, 1, 1, 0, 1, 1, 5661, 7274, 0, 4746, 1, 3363, 5151,
        9218, 1, 0, 0, 0, 0, 2589, 1, 5119,
      ],
      [
        7471, 0, 1, 8049, 0, 1, 0, 9407, 0, 0, 7815, 0, 1, 1, 8880, 1, 2833,
        7367, 0, 5528, 0, 2580, 4387, 5702, 0, 1, 1, 9718, 1, 0, 0, 0, 0, 9567,
        1, 2928, 7410, 0, 1, 1, 5630, 6435, 5256, 1, 0, 1881, 1, 6923, 9167, 0,
        1, 7195, 2830, 7069, 0, 4077, 0, 8929, 0, 0, 1, 1,
      ],
    ],
    [2960, 8631],
    [2, 38],
    144
  )
);
